(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"7awV":function(e,a,t){"use strict";var l=t("fbTi"),n=t("mZ4U");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=n(t("mK77"));t("pOT0");var r=n(t("/3qE")),o=n(t("43Yg")),d=n(t("/tCh")),u=n(t("scpF")),c=n(t("O/V9")),s=n(t("8aBX")),p=l(t("i9FB")),m=t("LneV"),f=n(t("hgAY")),h=n(t("a/LZ")),g=t("LGMr"),v=function(e){function a(){var e;return(0,o.default)(this,a),e=(0,u.default)(this,(0,c.default)(a).apply(this,arguments)),e.state={imgUrl:"",confirmLoading:!1,voltageAlarmValue:void 0,voltageAutomaticPoweroffValue:void 0,typeData:[],voltageId:"",voltageName:"",driverId:0,realName:""},e.formModalRef="",e.onRefChild=function(a){e.formModalRef=a},e.handleSubmitModal=function(a){var t=e.state,l=t.imgUrl,n=t.driverId,o=e.props,d=o.onOk,u=o.dispatch,c=o.modalData.id;if(0!==n){e.setState({confirmLoading:!0});var s=function(t){e.setState({confirmLoading:!1}),1===t.code?d(a):r.default.error(t.msg)},p=(0,h.default)(a.factoryTime).format("YYYY-MM-DD HH:mm:ss"),m=(0,h.default)(a.purchaseTime).format("YYYY-MM-DD HH:mm:ss");u({type:c?"carInfo/updateCar":"carInfo/addCar",payload:(0,i.default)({id:c},a,{cover:l,vehicleMemberId:n,factoryTime:p,purchaseTime:m}),callback:s})}else r.default.error("\u6ca1\u6709\u5bf9\u5e94\u8f66\u4e3b\u4fe1\u606f!")},e.setTypeValue=function(a,t){var l=e.props.typeData,n=[];l.forEach(function(e){e.vehicleBrands===a&&n.push(e)}),e.setState({typeData:n},function(){"edit"!==t&&e.formModalRef.clearFormValue("model",void 0)})},e.setVoltageValue=function(a){var t=e.props,l=t.voltageData,n=t.typeData,i="";n.forEach(function(e){e.vehicleModel===a&&(i=e.batteryId)}),l.forEach(function(a){a.id===i&&e.setState({voltageId:i,voltageName:a.model,voltageAlarmValue:a.lowVoltageAlarmValue,voltageAutomaticPoweroffValue:a.automaticPoweroffValue})})},e.handlePicChange=function(a,t){if(t.length>0){var l=t[0].response&&t[0].response.data;e.setState({imgUrl:l})}else e.setState({imgUrl:""})},e.filterDriver=function(a){var t="string"===typeof a?a:a.target.value,l=e.props.driverData;if(11===t.length){var n=!1;l.map(function(a){a.concatPhone===t&&(n=!0,e.setState({driverId:a.id,realName:a.realName}))}),n||r.default.error("\u5f53\u524d\u6ca1\u6709\u8be5\u8f66\u4e3b\u4fe1\u606f")}else e.setState({driverId:0,realName:""})},e}return(0,s.default)(a,e),(0,d.default)(a,[{key:"componentDidMount",value:function(){var e=this,a=this.props,t=a.voltageData,l=a.typeData,n=a.driverData,i=a.dispatch;if(t.length<=0&&i({type:"global/fetchVoltage",payload:{pageNum:1,pageSize:100}}),n.length<=0&&i({type:"global/fetchDriver",payload:{pageNum:1,pageSize:1e3}}),l.length<=0){var r=function(a){1===a.code&&e.setState({typeData:a.data.list})};i({type:"global/fetchType",payload:{pageNum:1,pageSize:100},callback:r})}}},{key:"componentWillReceiveProps",value:function(e){var a=e.modalData,t=a.brands,l=a.model,n=a.ownerContact,i=a.cover;i?this.setState({imgUrl:i}):this.setState({imgUrl:""}),n&&this.filterDriver(n),this.setTypeValue(t,"edit"),this.setVoltageValue(l)}},{key:"modalFromColumns",value:function(){var e=this.props.modalData,a=e.plate,t=e.brands,l=e.model,n=e.color,i=e.frameNumber,r=e.factoryTime,o=e.purchaseTime,d=e.initialMileage,u=e.ownerContact,c=e.vehicleEquipmentId,s=e.remarks,p=this.state,m=p.voltageAlarmValue,f=p.voltageAutomaticPoweroffValue,v=p.typeData,y=p.voltageName,I=p.imgUrl,D=p.realName;return[{title:"\u8f66\u724c\u53f7",dataIndex:"plate",componentType:"Input",initialValue:a,requiredMessage:"\u8bf7\u8f93\u5165\u8f66\u724c\u53f7",required:!0,placeholder:"\u8bf7\u8f93\u5165\u8f66\u724c\u53f7"},{title:"\u8f66\u8f86\u54c1\u724c",dataIndex:"brands",componentType:"Select",initialValue:t,requiredMessage:"\u8bf7\u9009\u62e9\u8f66\u8f86\u54c1\u724c",required:!0,placeholder:"\u8bf7\u9009\u62e9\u8f66\u8f86\u54c1\u724c",dataSource:g.CAR_BRAND,handleChange:this.setTypeValue},{title:"\u8f66\u8f86\u578b\u53f7",dataIndex:"model",componentType:"Select",selectName:"vehicleModel",value:"vehicleModel",initialValue:l,requiredMessage:"\u8bf7\u8f93\u5165\u8f66\u8f86\u578b\u53f7",required:!0,placeholder:"\u8bf7\u8f93\u5165\u8f66\u8f86\u578b\u53f7",dataSource:v,handleChange:this.setVoltageValue},{title:"\u51fa\u5382\u65e5\u671f",dataIndex:"factoryTime",componentType:"DatePicker",initialValue:r?(0,h.default)(r):"",requiredMessage:"\u8bf7\u9009\u62e9\u751f\u4ea7\u65e5\u671f",placeholder:"\u8bf7\u9009\u62e9\u8f66\u751f\u4ea7\u65e5\u671f",required:!0},{title:"\u7535\u74f6\u578b\u53f7",dataIndex:"batteryModel",componentType:"Input",disabled:!0,initialValue:y,requiredMessage:"\u8bf7\u8f93\u5165\u7535\u74f6\u578b\u53f7",placeholder:"\u8bf7\u9009\u62e9\u7535\u74f6\u578b\u53f7"},{title:"\u7535\u538b\u62a5\u8b66\u503c",dataIndex:"lowVoltageAlarmValue",componentType:"InputNumber",initialValue:m,placeholder:"\u8bf7\u9009\u62e9\u7535\u74f6\u578b\u53f7",disabled:!0},{title:"\u7535\u538b\u81ea\u52a8\u65ad\u7535\u503c",dataIndex:"automaticPoweroffValue",componentType:"InputNumber",initialValue:f,placeholder:"\u8bf7\u9009\u62e9\u7535\u74f6\u578b\u53f7",disabled:!0},{title:"\u8f66\u8f86\u989c\u8272",dataIndex:"color",componentType:"Input",initialValue:n,requiredMessage:"\u8bf7\u8f93\u5165\u8f66\u8f86\u989c\u8272",required:!0,placeholder:"\u8bf7\u8f93\u5165\u8f66\u8f86\u989c\u8272"},{title:"\u8f66\u67b6\u53f7",dataIndex:"frameNumber",componentType:"Input",initialValue:i,requiredMessage:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u8f66\u67b6\u53f7",required:!0,placeholder:"\u8bf7\u8f93\u5165\u8f66\u67b6\u53f7",maxLength:17},{title:"\u8d2d\u4e70\u65f6\u95f4",dataIndex:"purchaseTime",componentType:"DatePicker",initialValue:o?(0,h.default)(o):"",requiredMessage:"\u8bf7\u9009\u62e9\u51fa\u5382\u65f6\u95f4",placeholder:"\u8bf7\u9009\u62e9\u8f66\u51fa\u5382\u65f6\u95f4",required:!0},{title:"\u521d\u59cb\u91cc\u7a0b",dataIndex:"initialMileage",componentType:"InputNumber",initialValue:d,requiredMessage:"\u8bf7\u8f93\u5165\u521d\u59cb\u91cc\u7a0b",required:!0,placeholder:"\u8bf7\u8f93\u5165\u521d\u59cb\u91cc\u7a0b"},{title:"\u8f66\u4e3b\u8054\u7cfb\u65b9\u5f0f",dataIndex:"ownerContact",componentType:"Input",initialValue:u,requiredMessage:"\u8bf7\u8f93\u5165\u8f66\u4e3b\u8054\u7cfb\u65b9\u5f0f",onChange:this.filterDriver,required:!0,placeholder:"\u8bf7\u8f93\u5165\u8f66\u4e3b\u8054\u7cfb\u65b9\u5f0f"},{title:"\u8f66\u4e3b\u59d3\u540d",dataIndex:"ownerName",componentType:"Input",initialValue:D,disabled:!0,placeholder:"\u8bf7\u8f93\u5165\u8f66\u4e3b\u8054\u7cfb\u67e5\u8be2",requiredMessage:"\u8bf7\u8f93\u5165\u8f66\u4e3b\u59d3\u540d"},{title:"\u8f66\u8f7d\u8bbe\u5907ID",dataIndex:"vehicleEquipmentId",componentType:"Input",initialValue:c,requiredMessage:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u8f66\u8f7d\u8bbe\u5907ID(8\u4f4d)",required:!0,placeholder:"\u8bf7\u8f93\u5165\u8f66\u8f7d\u8bbe\u5907ID",maxLength:8},{title:"\u5907\u6ce8",dataIndex:"remarks",componentType:"Input",initialValue:s,placeholder:"\u8bf7\u8f93\u5165\u5907\u6ce8"},{title:"\u8f66\u8f86\u56fe\u7247",dataIndex:"cover",componentType:"Upload",initialValue:c,handleChange:this.handlePicChange,pictures:I,requiredMessage:"\u8bf7\u4e0a\u4f20\u8f66\u8f86\u56fe\u7247",required:!0,placeholder:"\u8bf7\u4e0a\u4f20\u8f66\u8f86\u56fe\u7247"}]}},{key:"render",value:function(){var e=this.state.confirmLoading,a=this.props,t=a.modalVisible,l=a.onCancel,n=a.modalData.id;return p.default.createElement(p.Fragment,null,p.default.createElement(f.default,{title:n?"\u4fee\u6539\u8f66\u8f86":"\u6dfb\u52a0\u8f66\u8f86",columns:this.modalFromColumns(),onOk:this.handleSubmitModal,visible:t,confirmLoading:e,width:1e3,onRefChild:this.onRefChild,onCancel:l}))}}]),a}(p.Component),y=(0,m.connect)(function(e){var a=e.global;return{voltageData:a.voltageData,typeData:a.typeData,driverData:a.driverData}})(v);a.default=y},HaVM:function(e,a,t){"use strict";var l=t("fbTi"),n=t("mZ4U");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,t("W3ek");var i=n(t("3N2t"));t("aMK7");var r=n(t("NgbC"));t("pOT0");var o=n(t("/3qE")),d=n(t("mK77")),u=n(t("43Yg")),c=n(t("/tCh")),s=n(t("scpF")),p=n(t("O/V9")),m=n(t("8aBX"));t("I1Ti");var f=n(t("r3a+")),h=l(t("i9FB")),g=t("LneV"),v=n(t("4EI+"));t("1OjR");var y=t("eDcw"),I=n(t("cPMy")),D=n(t("CEDc")),V=n(t("7awV")),M=t("LGMr"),T=f.default.confirm,b=function(e){function a(){var e;return(0,u.default)(this,a),e=(0,s.default)(this,(0,p.default)(a).apply(this,arguments)),e.state={loading:!1,modalVisible:!1,modalData:{},searchData:{},pageInfo:{pageSize:10,pageNum:1}},e.columns=[{title:"\u8f66\u724c\u53f7",dataIndex:"plate",key:"plate"},{title:"\u6c7d\u8f66\u54c1\u724c",dataIndex:"brands",key:"brands"},{title:"\u8f66\u8f86\u578b\u53f7",dataIndex:"model",key:"model"},{title:"\u8f66\u4e3b\u59d3\u540d",dataIndex:"ownerName",key:"ownerName"},{title:"\u8054\u7cfb\u65b9\u5f0f",dataIndex:"ownerContact",key:"ownerContact"},{title:"\u8f66\u8f7d\u8bbe\u5907ID",dataIndex:"vehicleEquipmentId",key:"vehicleEquipmentId"},{title:"\u5b9e\u65f6\u516c\u91cc\u6570",dataIndex:"initialMileage",key:"initialMileage"},{title:"\u7535\u538b\u72b6\u6001",dataIndex:"voltageState",key:"voltageState",render:function(e){var a="";return M.VOLTAGE_STATE.forEach(function(t){t.id===e&&(a=t.value)}),h.default.createElement("span",null,a)}},{title:"\u64cd\u4f5c",width:200,render:function(a){return h.default.createElement("div",{className:"table-operate"},h.default.createElement(v.default,{to:"/carInfo/carDetail/".concat(a.id)},"\u67e5\u770b"),h.default.createElement("a",{onClick:function(){return e.handleEdit(a)}},"\u4fee\u6539"),h.default.createElement("a",{onClick:function(){return e.handleDel(a.id)}},"\u5220\u9664"))}}],e.handleSubmitModal=function(){e.handleTriggerModal(),e.initData()},e.handleTriggerModal=function(){var a=e.state.modalVisible;e.setState({modalVisible:!a})},e.handleAddNew=function(){e.setState({modalData:{}}),e.handleTriggerModal()},e.handleEdit=function(a){e.setState({modalData:(0,d.default)({},a)}),e.handleTriggerModal()},e.handleDel=function(a){var t=e.props.dispatch,l=function(a){1===a.code?(o.default.success("\u64cd\u4f5c\u6210\u529f"),e.initData()):o.default.error(a.msg)};T({title:"\u7cfb\u7edf\u63d0\u793a",content:"\u786e\u8ba4\u8981\u5220\u9664\u8be5\u8bb0\u5f55\u5417\uff1f",onOk:function(){t&&t({type:"carInfo/delCar",payload:{id:a},callback:l})}})},e.getSerarchColumns=function(){var e=[{title:"\u8f66\u724c\u53f7",dataIndex:"plate",componentType:"Input"},{title:"\u7535\u538b\u72b6\u6001",dataIndex:"voltageState",componentType:"Select",dataSource:[{title:"\u6b63\u5e38",value:1},{title:"\u4f4e\u7535\u538b\u62a5\u8b66",value:2},{title:"\u8bbe\u5907\u5931\u8054",value:3},{title:"\u65ad\u7535\u4e2d",value:4}]},{title:"\u8f66\u4e3b\u59d3\u540d",dataIndex:"ownerName",componentType:"Input"},{title:"\u8f66\u4e3b\u8054\u7cfb\u65b9\u5f0f",dataIndex:"ownerContact",componentType:"Input"},{title:"\u8f66\u8f7d\u8bbe\u5907",dataIndex:"vehicleEquipmentId",componentType:"Input"}];return e},e.handleSearch=function(a){var t=e.state.searchData;e.setState({searchData:(0,d.default)({},t,a)},function(){e.initData()})},e.handleFormReset=function(){e.setState({searchData:{}},function(){e.initData()})},e}return(0,m.default)(a,e),(0,c.default)(a,[{key:"componentDidMount",value:function(){this.initData()}},{key:"initData",value:function(e){var a=this.props.dispatch,t=this.state,l=t.pageInfo,n=t.searchData,i={};for(var r in n)n[r]&&(i[r]=n[r]);e&&this.setState({pageInfo:{pageNum:e.pageNum,pageSize:e.pageSize}}),a&&a({type:"carInfo/fetchCar",payload:(0,d.default)({},i,l,e)})}},{key:"render",value:function(){var e=this,a=this.props,t=a.data,l=a.loading,n=this.state,o=n.modalVisible,d=n.modalData;return h.default.createElement(y.PageHeaderWrapper,null,h.default.createElement(r.default,null,h.default.createElement("div",{className:"flex-container"},h.default.createElement("div",{className:"flex-1"},h.default.createElement(D.default,{columns:this.getSerarchColumns(),handleSearch:this.handleSearch,handleFormReset:this.handleFormReset})),h.default.createElement("div",null,h.default.createElement(i.default,{type:"primary",onClick:this.handleAddNew},"\u6dfb\u52a0\u8f66\u8f86"))),h.default.createElement(I.default,{rowKey:"id",columns:this.columns,data:t||[],loading:l,onChangeCombine:function(a){return e.initData(a)}})),h.default.createElement(V.default,{modalVisible:o,modalData:d,onCancel:this.handleTriggerModal,onOk:this.handleSubmitModal}))}}]),a}(h.Component),S=(0,g.connect)(function(e){var a=e.carInfo,t=e.loading;return{data:a.carData,loading:t.models.carInfo}})(b);a.default=S}}]);